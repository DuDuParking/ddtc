<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script>
        /**
         * Created by Common on 14-9-12.
         */
        var deviceAgent = navigator.userAgent.toLowerCase();
        var agentID = deviceAgent.match(/(iphone|ipod|ipad|android)/) || '';
        var mobile = {
            iphone:agentID.indexOf("iphone")>=0
            ,android:agentID.indexOf("android")>=0
            ,ipad:agentID.indexOf("ipad")>=0
            ,ipad:agentID.indexOf("ipod")>=0
        }
        if(mobile.iphone){
            //alert('iphone');
            document.write('<meta name="viewport" content="width=device-width, initial-scale=01, user-scalable=0,minimal-ui">');
        }else if(mobile.android){
            //alert('android');
            document.write('<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">');
            //document.write('<meta name="viewport" content="target-densitydpi=device-dpi">');
        }else{
            //alert('other');
            document.write('<meta name="viewport" content="width=device-width, initial-scale=0.5, user-scalable=0,minimal-ui">');
        }
    </script>
    <style>
        html,body{
            margin: 0;
            padding: 0;
            height: 100%;
        }
        body{

        }
        .if1{
            width: 100%;
            height: 100%;
        }

    </style>
</head>
<body>
<iframe class="if1" border='0' src="http://duduche.me/html/secenhtml/index.html?1"></iframe>
<script>

    function sendInfoToAnotherDomain(info){
        var iframe=window.frames[0];
        iframe.postMessage(info,'http://duduche.me');           //限制域名
    }

</script>

<script type="text/javascript" src="cordova.js"></script>
<script>

var app = {
    // Application Constructor
    initialize: function() {
        this.bindEvents();
    },
    // Bind Event Listeners
    //
    // Bind any events that are required on startup. Common events are:
    // 'load', 'deviceready', 'offline', and 'online'.
    bindEvents: function() {
        document.addEventListener('deviceready', this.onDeviceReady, false);
    },
    // deviceready Event Handler
    //
    // The scope of 'this' is the event. In order to call the 'receivedEvent'
    // function, we must explicitly call 'app.receivedEvent(...);'
    onDeviceReady: function() {
        //初始化device
        device.onPushID = app.onPushID;
        device.onMsgData = app.onMsgData;

        //app.receivedEvent('deviceready');
    },
    // Update DOM on a Received Event
    /**
    receivedEvent: function(id) {
        var parentElement = document.getElementById(id);
        var listeningElement = parentElement.querySelector('.listening');
        var receivedElement = parentElement.querySelector('.received');

        listeningElement.setAttribute('style', 'display:none;');
        receivedElement.setAttribute('style', 'display:block;');

        receivedElement.innerHTML = 'Received Event: ' + id;

        console.log('Received Event: ' + id);
    },*/
    onPushID: function(data) {
        /**
        var parentElement = document.getElementById('deviceready');
        var listeningElement = parentElement.querySelector('.listening');
        var receivedElement = parentElement.querySelector('.received');

        listeningElement.setAttribute('style', 'display:none;');
        receivedElement.setAttribute('style', 'display:block;');
        receivedElement.innerHTML = 'PushID: ' + data;

        console.log('PushID: ' + data);
         */
        //setTimeout(function(){window.PushManager.PUSH_ID(data);});
        var obj = {
            pushid:data
        }
        setTimeout(function(){
            sendInfoToAnotherDomain(JSON.stringify(obj));
        });
    },
    onMsgData: function(data) {
        /**
    var parentElement = document.getElementById('deviceready');
        var listeningElement = parentElement.querySelector('.listening');
        var receivedElement = parentElement.querySelector('.received');

        listeningElement.setAttribute('style', 'display:none;');
        receivedElement.setAttribute('style', 'display:block;');
    receivedElement.innerHTML = 'MsgData: ' + data;

    console.log('MsgData: ' + data);
         */
        //setTimeout(function(){window.PushManager.PUSH_MSG(data);});
        setTimeout(function(){
            sendInfoToAnotherDomain(data);
        });
    }
};

app.initialize();
</script>
</body>
</html>